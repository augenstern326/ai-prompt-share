{"version":3,"file":"js/905.f83cc9c3.js","mappings":"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","sources":["webpack://frontend/./node_modules/@ant-design/icons-svg/es/asn/ReloadOutlined.js","webpack://frontend/./node_modules/@ant-design/icons-vue/es/icons/ReloadOutlined.js","webpack://frontend/./src/views/admin/AdminUser.vue","webpack://frontend/./src/views/admin/AdminUser.vue?6e02"],"sourcesContent":["// This icon file is generated automatically.\nvar ReloadOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z\" } }] }, \"name\": \"reload\", \"theme\": \"outlined\" };\nexport default ReloadOutlined;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport ReloadOutlinedSvg from \"@ant-design/icons-svg/es/asn/ReloadOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar ReloadOutlined = function ReloadOutlined(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": ReloadOutlinedSvg\n  }), null);\n};\n\nReloadOutlined.displayName = 'ReloadOutlined';\nReloadOutlined.inheritAttrs = false;\nexport default ReloadOutlined;","<template>\n  <div class=\"admin-user\">\n    <h1>用户管理</h1>\n    \n    <!-- 搜索和筛选 -->\n    <div class=\"filter-section\">\n      <a-row :gutter=\"16\">\n        <a-col :span=\"8\">\n          <a-input-search\n            v-model:value=\"searchKeyword\"\n            placeholder=\"搜索用户名或邮箱\"\n            enter-button\n            @search=\"handleSearch\"\n          />\n        </a-col>\n        <a-col :span=\"4\">\n          <a-select\n            v-model:value=\"role\"\n            style=\"width: 100%\"\n            @change=\"handleRoleChange\"\n          >\n            <a-select-option :value=\"-1\">全部角色</a-select-option>\n            <a-select-option :value=\"0\">普通用户</a-select-option>\n            <a-select-option :value=\"1\">管理员</a-select-option>\n          </a-select>\n        </a-col>\n        <a-col :span=\"4\">\n          <a-select\n            v-model:value=\"status\"\n            style=\"width: 100%\"\n            @change=\"handleStatusChange\"\n          >\n            <a-select-option :value=\"-1\">全部状态</a-select-option>\n            <a-select-option :value=\"1\">正常</a-select-option>\n            <a-select-option :value=\"0\">已禁用</a-select-option>\n          </a-select>\n        </a-col>\n        <a-col :span=\"4\">\n          <a-button type=\"primary\" @click=\"handleRefresh\">\n            <template #icon><reload-outlined /></template>\n            刷新\n          </a-button>\n        </a-col>\n      </a-row>\n    </div>\n    \n    <!-- 用户列表 -->\n    <a-table\n      :columns=\"columns\"\n      :data-source=\"users\"\n      :loading=\"loading\"\n      :pagination=\"pagination\"\n      @change=\"handleTableChange\"\n      row-key=\"id\"\n    >\n      <!-- 用户信息列 -->\n      <template #bodyCell=\"{ column, record }\">\n        <template v-if=\"column.key === 'user'\">\n          <div class=\"user-info\">\n            <a-avatar :src=\"record.avatar || '/avatar-default.png'\" />\n            <span>{{ record.username }}</span>\n          </div>\n        </template>\n        \n        <!-- 角色列 -->\n        <template v-if=\"column.key === 'role'\">\n          <a-tag :color=\"record.role === 'admin' ? 'purple' : 'blue'\">\n            {{ record.role === 'admin' ? '管理员' : '普通用户' }}\n          </a-tag>\n        </template>\n        \n        <!-- 状态列 -->\n        <template v-if=\"column.key === 'status'\">\n          <a-tag :color=\"record.status === 1 ? 'green' : 'red'\">\n            {{ record.status === 1 ? '正常' : '已禁用' }}\n          </a-tag>\n        </template>\n        \n        <!-- 操作列 -->\n        <template v-if=\"column.key === 'action'\">\n          <div class=\"action-buttons\">\n            <a-button type=\"link\" size=\"small\" @click=\"handleEdit(record)\">\n              编辑\n            </a-button>\n            <a-button \n              v-if=\"record.status === 1\" \n              type=\"link\" \n              size=\"small\" \n              danger \n              @click=\"handleDisable(record)\"\n            >\n              禁用\n            </a-button>\n            <a-button \n              v-else \n              type=\"link\" \n              size=\"small\" \n              @click=\"handleEnable(record)\"\n            >\n              启用\n            </a-button>\n            <a-button \n              v-if=\"record.role !== 'admin'\" \n              type=\"link\" \n              size=\"small\" \n              @click=\"handleSetAdmin(record)\"\n            >\n              设为管理员\n            </a-button>\n            <a-button \n              v-else \n              type=\"link\" \n              size=\"small\" \n              @click=\"handleRemoveAdmin(record)\"\n            >\n              取消管理员\n            </a-button>\n          </div>\n        </template>\n      </template>\n    </a-table>\n    \n    <!-- 编辑用户弹窗 -->\n    <a-modal\n      v-model:visible=\"editModalVisible\"\n      title=\"编辑用户信息\"\n      @ok=\"submitEdit\"\n      :confirmLoading=\"submitLoading\"\n    >\n      <a-form\n        :model=\"editForm\"\n        layout=\"vertical\"\n      >\n        <a-form-item label=\"用户名\" name=\"username\">\n          <a-input v-model:value=\"editForm.username\" disabled />\n        </a-form-item>\n        \n        <a-form-item label=\"邮箱\" name=\"email\" :rules=\"[{ required: true, type: 'email', message: '请输入有效的邮箱地址' }]\">\n          <a-input v-model:value=\"editForm.email\" />\n        </a-form-item>\n        \n        <a-form-item label=\"角色\" name=\"role\">\n          <a-select v-model:value=\"editForm.role\">\n            <a-select-option value=\"user\">普通用户</a-select-option>\n            <a-select-option value=\"admin\">管理员</a-select-option>\n          </a-select>\n        </a-form-item>\n        \n        <a-form-item label=\"状态\" name=\"status\">\n          <a-select v-model:value=\"editForm.status\">\n            <a-select-option :value=\"1\">正常</a-select-option>\n            <a-select-option :value=\"0\">禁用</a-select-option>\n          </a-select>\n        </a-form-item>\n      </a-form>\n    </a-modal>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue'\nimport { message } from 'ant-design-vue'\nimport { ReloadOutlined } from '@ant-design/icons-vue'\nimport api from '../../api'\n\n// 表格列定义\nconst columns = [\n  {\n    title: 'ID',\n    dataIndex: 'id',\n    key: 'id',\n    width: 80\n  },\n  {\n    title: '用户信息',\n    key: 'user'\n  },\n  {\n    title: '邮箱',\n    dataIndex: 'email',\n    key: 'email'\n  },\n  {\n    title: '角色',\n    key: 'role',\n    width: 100\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 100\n  },\n  {\n    title: '注册时间',\n    dataIndex: 'createTime',\n    key: 'createTime',\n    width: 180\n  },\n  {\n    title: '操作',\n    key: 'action',\n    width: 300\n  }\n]\n\n// 状态变量\nconst loading = ref(false)\nconst users = ref([])\nconst searchKeyword = ref('')\nconst role = ref(-1)\nconst status = ref(-1)\nconst pagination = reactive({\n  current: 1,\n  pageSize: 10,\n  total: 0,\n  showSizeChanger: true,\n  showQuickJumper: true\n})\n\n// 编辑相关\nconst editModalVisible = ref(false)\nconst submitLoading = ref(false)\nconst editForm = reactive({\n  id: null,\n  username: '',\n  email: '',\n  role: 'user',\n  status: 1\n})\n\n// 获取用户列表\nconst fetchUsers = async () => {\n  loading.value = true\n  try {\n    const res = await api.admin.getUserList({\n      current: pagination.current,\n      size: pagination.pageSize,\n      keyword: searchKeyword.value || undefined,\n      role: role.value >= 0 ? (role.value === 1 ? 'admin' : 'user') : undefined,\n      status: status.value >= 0 ? status.value : undefined\n    })\n    if (res.code === 200) {\n      users.value = res.data.records\n      pagination.total = res.data.total\n    }\n  } catch (error) {\n    console.error('获取用户列表失败', error)\n    message.error('获取用户列表失败')\n  } finally {\n    loading.value = false\n  }\n}\n\n// 搜索\nconst handleSearch = () => {\n  pagination.current = 1\n  fetchUsers()\n}\n\n// 角色筛选\nconst handleRoleChange = () => {\n  pagination.current = 1\n  fetchUsers()\n}\n\n// 状态筛选\nconst handleStatusChange = () => {\n  pagination.current = 1\n  fetchUsers()\n}\n\n// 刷新\nconst handleRefresh = () => {\n  fetchUsers()\n}\n\n// 表格变化（分页、排序等）\nconst handleTableChange = (pag) => {\n  pagination.current = pag.current\n  pagination.pageSize = pag.pageSize\n  fetchUsers()\n}\n\n// 编辑用户\nconst handleEdit = (record) => {\n  editForm.id = record.id\n  editForm.username = record.username\n  editForm.email = record.email\n  editForm.role = record.role\n  editForm.status = record.status\n  editModalVisible.value = true\n}\n\n// 提交编辑\nconst submitEdit = async () => {\n  if (!editForm.email) {\n    message.warning('请填写邮箱')\n    return\n  }\n  \n  submitLoading.value = true\n  try {\n    const res = await api.admin.updateUser({\n      id: editForm.id,\n      email: editForm.email,\n      role: editForm.role,\n      status: editForm.status\n    })\n    if (res.code === 200) {\n      message.success('更新成功')\n      editModalVisible.value = false\n      fetchUsers()\n    } else {\n      message.error(res.message || '更新失败')\n    }\n  } catch (error) {\n    message.error('更新失败，请稍后重试')\n  } finally {\n    submitLoading.value = false\n  }\n}\n\n// 禁用用户\nconst handleDisable = async (record) => {\n  try {\n    const res = await api.admin.updateUserStatus(record.id, 0)\n    if (res.code === 200) {\n      message.success('用户已禁用')\n      fetchUsers()\n    } else {\n      message.error(res.message || '操作失败')\n    }\n  } catch (error) {\n    message.error('操作失败，请稍后重试')\n  }\n}\n\n// 启用用户\nconst handleEnable = async (record) => {\n  try {\n    const res = await api.admin.updateUserStatus(record.id, 1)\n    if (res.code === 200) {\n      message.success('用户已启用')\n      fetchUsers()\n    } else {\n      message.error(res.message || '操作失败')\n    }\n  } catch (error) {\n    message.error('操作失败，请稍后重试')\n  }\n}\n\n// 设为管理员\nconst handleSetAdmin = async (record) => {\n  try {\n    const res = await api.admin.updateUserRole(record.id, 'admin')\n    if (res.code === 200) {\n      message.success('已设为管理员')\n      fetchUsers()\n    } else {\n      message.error(res.message || '操作失败')\n    }\n  } catch (error) {\n    message.error('操作失败，请稍后重试')\n  }\n}\n\n// 取消管理员\nconst handleRemoveAdmin = async (record) => {\n  try {\n    const res = await api.admin.updateUserRole(record.id, 'user')\n    if (res.code === 200) {\n      message.success('已取消管理员权限')\n      fetchUsers()\n    } else {\n      message.error(res.message || '操作失败')\n    }\n  } catch (error) {\n    message.error('操作失败，请稍后重试')\n  }\n}\n\nonMounted(() => {\n  fetchUsers()\n})\n</script>\n\n<style scoped>\n.admin-user {\n  padding: 0 0 20px 0;\n}\n\n.filter-section {\n  margin-bottom: 20px;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.action-buttons {\n  display: flex;\n  flex-wrap: wrap;\n}\n</style>\n","import script from \"./AdminUser.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AdminUser.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AdminUser.vue?vue&type=style&index=0&id=5343b50d&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5343b50d\"]])\n\nexport default __exports__"],"names":["ReloadOutlined","_objectSpread","target","i","arguments","length","source","Object","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","props","context","p","attrs","_createVNode","AntdIcon","ReloadOutlinedSvg","displayName","inheritAttrs","columns","title","dataIndex","width","loading","ref","users","searchKeyword","role","status","pagination","reactive","current","pageSize","total","showSizeChanger","showQuickJumper","editModalVisible","submitLoading","editForm","id","username","email","fetchUsers","async","res","api","admin","getUserList","size","keyword","undefined","code","data","records","error","console","message","handleSearch","handleRoleChange","handleStatusChange","handleRefresh","handleTableChange","pag","handleEdit","record","submitEdit","updateUser","success","warning","handleDisable","updateUserStatus","handleEnable","handleSetAdmin","updateUserRole","handleRemoveAdmin","onMounted","__exports__"],"sourceRoot":""}