{"version":3,"file":"js/802.3af883ec.js","mappings":"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","sources":["webpack://frontend/./src/views/prompt/PromptCreate.vue","webpack://frontend/./src/views/prompt/PromptCreate.vue?30c7","webpack://frontend/./node_modules/@ant-design/icons-svg/es/asn/UploadOutlined.js","webpack://frontend/./node_modules/@ant-design/icons-vue/es/icons/UploadOutlined.js"],"sourcesContent":["<template>\n  <div class=\"prompt-create\">\n    <div class=\"container\">\n      <div class=\"prompt-create-header\">\n        <h1>{{ isEdit ? '编辑提示词' : '创建提示词' }}</h1>\n        <p>{{ isEdit ? '修改您的提示词内容和信息' : '分享您的AI提示词，帮助更多人创作' }}</p>\n      </div>\n      \n      <div class=\"prompt-create-form\">\n        <a-form\n          :model=\"formData\"\n          :rules=\"rules\"\n          layout=\"vertical\"\n          @finish=\"handleSubmit\"\n        >\n          <a-form-item label=\"标题\" name=\"title\">\n            <a-input v-model:value=\"formData.title\" placeholder=\"请输入提示词标题\" />\n          </a-form-item>\n          \n          <a-form-item label=\"提示词内容\" name=\"content\">\n            <a-textarea \n              v-model:value=\"formData.content\" \n              placeholder=\"请输入提示词内容\" \n              :rows=\"8\" \n            />\n          </a-form-item>\n          \n          <a-form-item label=\"标签\" name=\"tagIds\">\n            <a-select\n              v-model:value=\"formData.tagIds\"\n              mode=\"multiple\"\n              placeholder=\"选择或创建标签\"\n              :options=\"tagOptions\"\n              :loading=\"tagsLoading\"\n              :tokenSeparators=\"[',']\"\n              @change=\"handleTagChange\"\n            >\n              <template #dropdownRender=\"{ menuNode: menu }\">\n                <div>\n                  {{ menu }}\n                  <a-divider style=\"margin: 4px 0\" />\n                  <div style=\"padding: 8px; cursor: pointer\">\n                    <a-input\n                      v-model:value=\"newTagName\"\n                      placeholder=\"输入新标签名称\"\n                      @pressEnter=\"addTag\"\n                    >\n                      <template #suffix>\n                        <a-button type=\"link\" @click=\"addTag\">添加</a-button>\n                      </template>\n                    </a-input>\n                  </div>\n                </div>\n              </template>\n            </a-select>\n          </a-form-item>\n          \n          <a-form-item label=\"效果图片\" name=\"imageUrl\">\n            <a-upload\n              v-model:fileList=\"fileList\"\n              list-type=\"picture-card\"\n              :before-upload=\"beforeUpload\"\n              @preview=\"handlePreview\"\n              @change=\"handleChange\"\n              :maxCount=\"1\"\n            >\n              <div v-if=\"fileList.length < 1\">\n                <upload-outlined />\n                <div style=\"margin-top: 8px\">上传图片</div>\n              </div>\n            </a-upload>\n            <a-modal\n              :visible=\"previewVisible\"\n              :title=\"previewTitle\"\n              :footer=\"null\"\n              @cancel=\"previewVisible = false\"\n            >\n              <img alt=\"预览图片\" style=\"width: 100%\" :src=\"previewImage\" />\n            </a-modal>\n          </a-form-item>\n          \n          <a-form-item>\n            <a-button type=\"primary\" html-type=\"submit\" :loading=\"submitLoading\">\n              {{ isEdit ? '保存修改' : '创建提示词' }}\n            </a-button>\n            <a-button style=\"margin-left: 10px\" @click=\"goBack\">取消</a-button>\n          </a-form-item>\n        </a-form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { message } from 'ant-design-vue'\nimport { UploadOutlined } from '@ant-design/icons-vue'\nimport api from '../../api'\n\nconst route = useRoute()\nconst router = useRouter()\nconst isEdit = computed(() => route.path.includes('/edit/'))\nconst promptId = computed(() => isEdit.value ? route.params.id : null)\n\nconst submitLoading = ref(false)\nconst tagsLoading = ref(false)\nconst tagOptions = ref([])\nconst newTagName = ref('')\nconst fileList = ref([])\nconst previewVisible = ref(false)\nconst previewImage = ref('')\nconst previewTitle = ref('')\n\n// 表单数据\nconst formData = reactive({\n  title: '',\n  content: '',\n  tagIds: [],\n  imageUrl: ''\n})\n\n// 表单验证规则\nconst rules = {\n  title: [\n    { required: true, message: '请输入提示词标题', trigger: 'blur' },\n    { max: 100, message: '标题长度不能超过100个字符', trigger: 'blur' }\n  ],\n  content: [\n    { required: true, message: '请输入提示词内容', trigger: 'blur' }\n  ],\n  tagIds: [\n    { required: true, type: 'array', min: 1, message: '请至少选择一个标签', trigger: 'change' }\n  ]\n}\n\n// 获取标签列表\nconst fetchTags = async () => {\n  tagsLoading.value = true\n  try {\n    const res = await api.tag.getTagList()\n    if (res.code === 200) {\n      tagOptions.value = res.data.map(tag => ({\n        label: tag.name,\n        value: tag.id\n      }))\n    }\n  } catch (error) {\n    console.error('获取标签列表失败', error)\n  } finally {\n    tagsLoading.value = false\n  }\n}\n\n// 添加新标签\nconst addTag = async () => {\n  if (!newTagName.value) {\n    message.warning('请输入标签名称')\n    return\n  }\n  \n  try {\n    const res = await api.tag.createTag({\n      name: newTagName.value,\n      type: 1 // 用户创建\n    })\n    if (res.code === 200) {\n      const newTagId = res.data\n      tagOptions.value.push({\n        label: newTagName.value,\n        value: newTagId\n      })\n      formData.tagIds.push(newTagId)\n      newTagName.value = ''\n      message.success('标签创建成功')\n    }\n  } catch (error) {\n    message.error('创建标签失败，请稍后重试')\n  }\n}\n\n// 处理标签变化\nconst handleTagChange = (value) => {\n  formData.tagIds = value\n}\n\n// 上传图片前的处理\nconst beforeUpload = (file) => {\n  const isImage = file.type.startsWith('image/')\n  if (!isImage) {\n    message.error('只能上传图片文件!')\n  }\n  \n  const isLt2M = file.size / 1024 / 1024 < 2\n  if (!isLt2M) {\n    message.error('图片大小不能超过2MB!')\n  }\n  \n  return false // 阻止自动上传，改为手动上传\n}\n\n// 处理图片预览\nconst handlePreview = async (file) => {\n  if (!file.url && !file.preview) {\n    file.preview = await getBase64(file.originFileObj)\n  }\n  previewImage.value = file.url || file.preview\n  previewVisible.value = true\n  previewTitle.value = file.name || file.url.substring(file.url.lastIndexOf('/') + 1)\n}\n\n// 处理图片变化\nconst handleChange = ({ fileList: newFileList }) => {\n  fileList.value = newFileList\n}\n\n// 将文件转为Base64\nconst getBase64 = (file) => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => resolve(reader.result)\n    reader.onerror = error => reject(error)\n  })\n}\n\n// 上传图片\nconst uploadImage = async (file) => {\n  // 注意：这里应该调用MinIO上传接口，但由于MinIO集成在步骤9中完成，这里先模拟\n  // 实际项目中，这里应该调用后端的图片上传接口\n  return Promise.resolve(`/uploads/${file.name}`) // 模拟返回图片URL\n}\n\n// 获取提示词详情（编辑模式）\nconst fetchPromptDetail = async () => {\n  if (!isEdit.value) return\n  \n  try {\n    const res = await api.prompt.getPromptDetail(promptId.value)\n    if (res.code === 200) {\n      const { title, content, imageUrl, tags } = res.data\n      formData.title = title\n      formData.content = content\n      formData.imageUrl = imageUrl\n      formData.tagIds = tags.map(tag => tag.id)\n      \n      if (imageUrl) {\n        fileList.value = [{\n          uid: '-1',\n          name: imageUrl.substring(imageUrl.lastIndexOf('/') + 1),\n          status: 'done',\n          url: imageUrl\n        }]\n      }\n    }\n  } catch (error) {\n    message.error('获取提示词详情失败')\n    router.push('/prompt/square')\n  }\n}\n\n// 提交表单\nconst handleSubmit = async () => {\n  submitLoading.value = true\n  \n  try {\n    // 上传图片（如果有）\n    if (fileList.value.length > 0 && fileList.value[0].originFileObj) {\n      formData.imageUrl = await uploadImage(fileList.value[0].originFileObj)\n    }\n    \n    let res\n    if (isEdit.value) {\n      // 更新提示词\n      res = await api.prompt.updatePrompt({\n        id: promptId.value,\n        ...formData\n      })\n    } else {\n      // 创建提示词\n      res = await api.prompt.createPrompt(formData)\n    }\n    \n    if (res.code === 200) {\n      message.success(isEdit.value ? '提示词更新成功' : '提示词创建成功')\n      if (isEdit.value) {\n        router.push(`/prompt/detail/${promptId.value}`)\n      } else {\n        router.push(`/prompt/detail/${res.data}`)\n      }\n    } else {\n      message.error(res.message || '操作失败')\n    }\n  } catch (error) {\n    message.error('操作失败，请稍后重试')\n  } finally {\n    submitLoading.value = false\n  }\n}\n\n// 返回上一页\nconst goBack = () => {\n  router.back()\n}\n\nonMounted(() => {\n  fetchTags()\n  fetchPromptDetail()\n})\n</script>\n\n<style scoped>\n.prompt-create {\n  padding-bottom: 40px;\n}\n\n.prompt-create-header {\n  text-align: center;\n  margin-bottom: 32px;\n}\n\n.prompt-create-header h1 {\n  font-size: 32px;\n  margin-bottom: 8px;\n  background: var(--primary-gradient);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  display: inline-block;\n}\n\n.prompt-create-header p {\n  color: var(--text-color-light);\n  font-size: 16px;\n}\n\n.prompt-create-form {\n  background: white;\n  border-radius: var(--border-radius-large);\n  box-shadow: var(--box-shadow);\n  padding: 32px;\n  max-width: 800px;\n  margin: 0 auto;\n}\n</style>\n","import script from \"./PromptCreate.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PromptCreate.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PromptCreate.vue?vue&type=style&index=0&id=5644ae35&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5644ae35\"]])\n\nexport default __exports__","// This icon file is generated automatically.\nvar UploadOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z\" } }] }, \"name\": \"upload\", \"theme\": \"outlined\" };\nexport default UploadOutlined;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport UploadOutlinedSvg from \"@ant-design/icons-svg/es/asn/UploadOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar UploadOutlined = function UploadOutlined(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": UploadOutlinedSvg\n  }), null);\n};\n\nUploadOutlined.displayName = 'UploadOutlined';\nUploadOutlined.inheritAttrs = false;\nexport default UploadOutlined;"],"names":["route","useRoute","router","useRouter","isEdit","computed","path","includes","promptId","value","params","id","submitLoading","ref","tagsLoading","tagOptions","newTagName","fileList","previewVisible","previewImage","previewTitle","formData","reactive","title","content","tagIds","imageUrl","rules","required","message","trigger","max","type","min","fetchTags","async","res","api","tag","getTagList","code","data","map","label","name","error","console","addTag","createTag","newTagId","push","success","warning","handleTagChange","beforeUpload","file","isImage","startsWith","isLt2M","size","handlePreview","url","preview","getBase64","originFileObj","substring","lastIndexOf","handleChange","newFileList","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","uploadImage","fetchPromptDetail","prompt","getPromptDetail","tags","uid","status","handleSubmit","length","updatePrompt","createPrompt","goBack","back","onMounted","__exports__","UploadOutlined","_objectSpread","target","i","arguments","source","Object","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","defineProperty","configurable","writable","props","context","p","attrs","_createVNode","AntdIcon","UploadOutlinedSvg","displayName","inheritAttrs"],"sourceRoot":""}