"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[991],{723:function(e,a,t){t.d(a,{A:function(){return s}});t(8111),t(2489),t(7588);var l=t(6768),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},n=r,u=t(7526);function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},l=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),l.forEach((function(a){i(e,a,t[a])}))}return e}function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var d=function(e,a){var t=o({},e,a.attrs);return(0,l.bF)(u.A,o({},t,{icon:n}),null)};d.displayName="ReloadOutlined",d.inheritAttrs=!1;var s=d},3991:function(e,a,t){t.r(a),t.d(a,{default:function(){return _}});var l=t(6768),r=t(144),n=t(4232),u=t(7694),o=t(723),i=t(3397);const d={class:"admin-report"},s={class:"filter-section"},c={key:1,class:"user-info"},p={class:"reason-text"},v={key:4,class:"action-buttons"},b={style:{"margin-top":"16px","text-align":"right"}};var k={__name:"AdminReport",setup(e){const a=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"提示词",key:"prompt",width:200},{title:"举报者",key:"reporter",width:150},{title:"举报理由",key:"reason"},{title:"状态",key:"status",width:100},{title:"举报时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",key:"action",width:180}],t=(0,r.KR)(!1),k=(0,r.KR)([]),f=(0,r.KR)(""),m=(0,r.KR)(-1),_=(0,r.Kh)({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),g=(0,r.KR)(!1),y=(0,r.KR)(!1),h=(0,r.Kh)({id:null,promptId:null,promptTitle:"",reason:"",action:1,handleNote:""}),F=(0,r.KR)(!1),w=(0,r.Kh)({id:null,promptId:null,promptTitle:"",reporterName:"",reason:"",createTime:"",status:0,handlerName:"",handleTime:"",action:null,handleNote:""}),W=async()=>{t.value=!0;try{const e=await i["default"].admin.getReportList({current:_.current,size:_.pageSize,keyword:f.value||void 0,status:m.value>=0?m.value:void 0});200===e.code&&(k.value=e.data.records,_.total=e.data.total)}catch(e){console.error("获取举报列表失败",e),u.Ay.error("获取举报列表失败")}finally{t.value=!1}},C=()=>{_.current=1,W()},A=()=>{_.current=1,W()},N=()=>{W()},T=e=>{_.current=e.current,_.pageSize=e.pageSize,W()},I=e=>{h.id=e.id,h.promptId=e.promptId,h.promptTitle=e.promptTitle,h.reason=e.reason,h.action=1,h.handleNote="",g.value=!0},R=async e=>{try{const a=await i["default"].admin.handleReport(e.id,{status:2,action:0,handleNote:"管理员已忽略此举报"});200===a.code?(u.Ay.success("已忽略此举报"),W()):u.Ay.error(a.message||"操作失败")}catch(a){u.Ay.error("操作失败，请稍后重试")}},O=e=>{Object.assign(w,e),F.value=!0},z=async()=>{if(h.action){y.value=!0;try{const e=await i["default"].admin.handleReport(h.id,{status:1,action:h.action,handleNote:h.handleNote});200===e.code?(u.Ay.success("处理成功"),g.value=!1,1===h.action&&await i["default"].prompt.deletePrompt(h.promptId),W()):u.Ay.error(e.message||"处理失败")}catch(e){u.Ay.error("处理失败，请稍后重试")}finally{y.value=!1}}else u.Ay.warning("请选择处理方式")},K=e=>{switch(e){case 0:return"orange";case 1:return"green";case 2:return"gray";default:return"blue"}},Q=e=>{switch(e){case 0:return"待处理";case 1:return"已处理";case 2:return"已忽略";default:return"未知"}},U=e=>{switch(e){case 0:return"忽略";case 1:return"删除提示词";case 2:return"保留提示词";case 3:return"警告用户";default:return"未知"}};return(0,l.sV)((()=>{W()})),(e,u)=>{const i=(0,l.g2)("a-input-search"),W=(0,l.g2)("a-col"),X=(0,l.g2)("a-select-option"),x=(0,l.g2)("a-select"),L=(0,l.g2)("a-button"),S=(0,l.g2)("a-row"),j=(0,l.g2)("router-link"),E=(0,l.g2)("a-avatar"),P=(0,l.g2)("a-tooltip"),D=(0,l.g2)("a-tag"),$=(0,l.g2)("a-table"),q=(0,l.g2)("a-input"),B=(0,l.g2)("a-form-item"),J=(0,l.g2)("a-textarea"),M=(0,l.g2)("a-radio"),V=(0,l.g2)("a-radio-group"),G=(0,l.g2)("a-form"),H=(0,l.g2)("a-modal"),Y=(0,l.g2)("a-descriptions-item"),Z=(0,l.g2)("a-descriptions");return(0,l.uX)(),(0,l.CE)("div",d,[u[22]||(u[22]=(0,l.Lk)("h1",null,"举报管理",-1)),(0,l.Lk)("div",s,[(0,l.bF)(S,{gutter:16},{default:(0,l.k6)((()=>[(0,l.bF)(W,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(i,{value:f.value,"onUpdate:value":u[0]||(u[0]=e=>f.value=e),placeholder:"搜索举报内容","enter-button":"",onSearch:C},null,8,["value"])])),_:1}),(0,l.bF)(W,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(x,{value:m.value,"onUpdate:value":u[1]||(u[1]=e=>m.value=e),style:{width:"100%"},onChange:A},{default:(0,l.k6)((()=>[(0,l.bF)(X,{value:-1},{default:(0,l.k6)((()=>u[10]||(u[10]=[(0,l.eW)("全部状态")]))),_:1}),(0,l.bF)(X,{value:0},{default:(0,l.k6)((()=>u[11]||(u[11]=[(0,l.eW)("待处理")]))),_:1}),(0,l.bF)(X,{value:1},{default:(0,l.k6)((()=>u[12]||(u[12]=[(0,l.eW)("已处理")]))),_:1}),(0,l.bF)(X,{value:2},{default:(0,l.k6)((()=>u[13]||(u[13]=[(0,l.eW)("已忽略")]))),_:1})])),_:1},8,["value"])])),_:1}),(0,l.bF)(W,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(L,{type:"primary",onClick:N},{icon:(0,l.k6)((()=>[(0,l.bF)((0,r.R1)(o.A))])),default:(0,l.k6)((()=>[u[14]||(u[14]=(0,l.eW)(" 刷新 "))])),_:1})])),_:1})])),_:1})]),(0,l.bF)($,{columns:a,"data-source":k.value,loading:t.value,pagination:_,onChange:T,"row-key":"id"},{bodyCell:(0,l.k6)((({column:e,record:a})=>["prompt"===e.key?((0,l.uX)(),(0,l.Wv)(j,{key:0,to:`/prompt/detail/${a.promptId}`,target:"_blank"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(a.promptTitle),1)])),_:2},1032,["to"])):(0,l.Q3)("",!0),"reporter"===e.key?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bF)(E,{src:a.reporterAvatar||"/avatar-default.png",size:"small"},null,8,["src"]),(0,l.Lk)("span",null,(0,n.v_)(a.reporterName),1)])):(0,l.Q3)("",!0),"reason"===e.key?((0,l.uX)(),(0,l.Wv)(P,{key:2,title:a.reason},{default:(0,l.k6)((()=>[(0,l.Lk)("div",p,(0,n.v_)(a.reason),1)])),_:2},1032,["title"])):(0,l.Q3)("",!0),"status"===e.key?((0,l.uX)(),(0,l.Wv)(D,{key:3,color:K(a.status)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(Q(a.status)),1)])),_:2},1032,["color"])):(0,l.Q3)("",!0),"action"===e.key?((0,l.uX)(),(0,l.CE)("div",v,[0===a.status?((0,l.uX)(),(0,l.Wv)(L,{key:0,type:"link",size:"small",onClick:e=>I(a)},{default:(0,l.k6)((()=>u[15]||(u[15]=[(0,l.eW)(" 处理 ")]))),_:2},1032,["onClick"])):(0,l.Q3)("",!0),0===a.status?((0,l.uX)(),(0,l.Wv)(L,{key:1,type:"link",size:"small",onClick:e=>R(a)},{default:(0,l.k6)((()=>u[16]||(u[16]=[(0,l.eW)(" 忽略 ")]))),_:2},1032,["onClick"])):(0,l.Q3)("",!0),(0,l.bF)(L,{type:"link",size:"small",onClick:e=>O(a)},{default:(0,l.k6)((()=>u[17]||(u[17]=[(0,l.eW)(" 查看详情 ")]))),_:2},1032,["onClick"])])):(0,l.Q3)("",!0)])),_:1},8,["data-source","loading","pagination"]),(0,l.bF)(H,{visible:g.value,"onUpdate:visible":u[7]||(u[7]=e=>g.value=e),title:"处理举报",onOk:z,confirmLoading:y.value},{default:(0,l.k6)((()=>[(0,l.bF)(G,{model:h,layout:"vertical"},{default:(0,l.k6)((()=>[(0,l.bF)(B,{label:"举报ID"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{value:h.id,"onUpdate:value":u[2]||(u[2]=e=>h.id=e),disabled:""},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"提示词标题"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{value:h.promptTitle,"onUpdate:value":u[3]||(u[3]=e=>h.promptTitle=e),disabled:""},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"举报理由"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:h.reason,"onUpdate:value":u[4]||(u[4]=e=>h.reason=e),disabled:"",rows:3},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"处理方式",name:"action",rules:[{required:!0,message:"请选择处理方式"}]},{default:(0,l.k6)((()=>[(0,l.bF)(V,{value:h.action,"onUpdate:value":u[5]||(u[5]=e=>h.action=e)},{default:(0,l.k6)((()=>[(0,l.bF)(M,{value:1},{default:(0,l.k6)((()=>u[18]||(u[18]=[(0,l.eW)("删除提示词")]))),_:1}),(0,l.bF)(M,{value:2},{default:(0,l.k6)((()=>u[19]||(u[19]=[(0,l.eW)("保留提示词")]))),_:1}),(0,l.bF)(M,{value:3},{default:(0,l.k6)((()=>u[20]||(u[20]=[(0,l.eW)("警告用户")]))),_:1})])),_:1},8,["value"])])),_:1}),(0,l.bF)(B,{label:"处理备注",name:"handleNote"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:h.handleNote,"onUpdate:value":u[6]||(u[6]=e=>h.handleNote=e),placeholder:"请输入处理备注",rows:3},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","confirmLoading"]),(0,l.bF)(H,{visible:F.value,"onUpdate:visible":u[9]||(u[9]=e=>F.value=e),title:"举报详情",footer:"{null}",width:"700px"},{default:(0,l.k6)((()=>[(0,l.bF)(Z,{bordered:""},{default:(0,l.k6)((()=>[(0,l.bF)(Y,{label:"举报ID",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.id),1)])),_:1}),(0,l.bF)(Y,{label:"提示词标题",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.bF)(j,{to:`/prompt/detail/${w.promptId}`,target:"_blank"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.promptTitle),1)])),_:1},8,["to"])])),_:1}),(0,l.bF)(Y,{label:"举报者",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.reporterName),1)])),_:1}),(0,l.bF)(Y,{label:"举报理由",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.reason),1)])),_:1}),(0,l.bF)(Y,{label:"举报时间",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.createTime),1)])),_:1}),(0,l.bF)(Y,{label:"状态",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.bF)(D,{color:K(w.status)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(Q(w.status)),1)])),_:1},8,["color"])])),_:1}),0!==w.status?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.bF)(Y,{label:"处理人",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.handlerName),1)])),_:1}),(0,l.bF)(Y,{label:"处理时间",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.handleTime),1)])),_:1}),(0,l.bF)(Y,{label:"处理方式",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(U(w.action)),1)])),_:1}),(0,l.bF)(Y,{label:"处理备注",span:"{3}"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(w.handleNote),1)])),_:1})],64)):(0,l.Q3)("",!0)])),_:1}),(0,l.Lk)("div",b,[(0,l.bF)(L,{onClick:u[8]||(u[8]=e=>F.value=!1)},{default:(0,l.k6)((()=>u[21]||(u[21]=[(0,l.eW)("关闭")]))),_:1})])])),_:1},8,["visible"])])}}},f=t(1241);const m=(0,f.A)(k,[["__scopeId","data-v-8d4f10d6"]]);var _=m}}]);
//# sourceMappingURL=991.edd20c2f.js.map